var e=Object.defineProperty,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,a=(t,r,o)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[r]=o,s=(e,t,r)=>(a(e,"symbol"!=typeof t?t+"":t,r),r);import{r as l,j as n,a as i,b as c,N as d,c as h,u as m,d as p,L as u,B as g,R as f,e as b,f as v,g as S,P as y}from"./vendor.de1c181e.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();class w extends l.exports.Component{render(){return n("div",{className:"card",children:[i("div",{children:i("img",{src:this.props.image,alt:this.props.title})}),n("div",{className:"contenido-card",children:[i("h3",{children:this.props.title}),i("a",{href:"/pdf/"+this.props.title,children:"Editar"})]})]})}}class I extends l.exports.Component{constructor(e){super(e),s(this,"custom_file_upload_url","http://localhost:8080/upload"),s(this,"handleImagePreview",(e=>{let t=URL.createObjectURL(e.target.files[0]),r=e.target.files[0];this.setState({image_preview:t,image_file:r})})),s(this,"handleSubmitFile",(()=>{if(null!==this.state.image_file){let e=new FormData;e.append("myFile",this.state.image_file),c.post("http://localhost:8080/upload",e,{headers:{token:localStorage.getItem("Session")}}).then((e=>{console.log("Success"+e.data)})).catch((e=>{console.log(e)}))}})),this.state={image_file:null,image_preview:""}}render(){return i("div",{children:n("div",{className:"card",children:[i("div",{children:i("img",{src:this.props.image,alt:this.props.title})}),n("div",{className:"contenido-card",children:[i("h3",{children:this.props.title}),i("input",{type:"file",onChange:this.handleImagePreview,name:"myFile"}),i("button",{type:"submit",onClick:this.handleSubmitFile,children:"Subir"})]})]})})}}const N=()=>{const[e,t]=l.exports.useState([]);let r={};return 0!==e.length&&0!==Object.keys(r)||c.post("https://apibotservice.azurewebsites.net/apiBot/services/AccessApi/getProjects",{idUser:localStorage.getItem("userId")}).then((o=>{r=o,t(o.data.projects),null==e&&t([])})).catch((function(e){console.log(e)})),null!=localStorage.getItem("Session")&&Date.now()-localStorage.getItem("lastlogin")<864e5?(console.log("liyesss"),console.log(e),n("div",{className:"homecontainer",children:[n("div",{className:"container-card",children:[i(I,{title:"Agregar Libro",image:"http://localhost:8080/images/Plus_symbol.png",onsub:()=>{t([])}}),e.map((e=>i(w,{title:e.projectDesc,image:""},e.idProject)))]}),i("br",{}),i("br",{})]})):(localStorage.removeItem("Session"),i(d,{to:"/"}))},C=h({name:"autorize",initialState:{token:localStorage.getItem("Session")},reducers:{setTok:(e,t)=>{e.token=t.payload}}}),{setTok:k}=C.actions,x=e=>e.autorize.token;var E=C.reducer;const L=({posts:e})=>{const t=m(x),r=p(),o=()=>(r(k("")),localStorage.removeItem("Session"),i(d,{to:"/"}));return i("div",{children:n("nav",{children:[i("label",{htmlFor:"check",className:"checkbtn"}),i("label",{className:"logo",children:"ChatBot"}),n("ul",{children:[i("li",{children:i("a",{href:"/home",children:"HomePage"})}),i("li",{children:i(u,t?{to:"/",onClick:o,children:"Logout"}:{to:"/",children:"Login"})})]})]})})};const O=e=>{const[t,r]=l.exports.useState(""),[o,a]=l.exports.useState(""),[s,h]=l.exports.useState(""),m=e=>r(e.target.value),p=e=>a(e.target.value),g=async e=>{e.preventDefault();const r=await(async(e,t)=>{var r="";const o={Correo:e,Clave:t},a=JSON.stringify(o);return await c.put("http://apis.developingbrutality.ga/iniciosesion",a).then((e=>{localStorage.setItem("Session",e.data.Value),localStorage.setItem("lastlogin",Date.now()),localStorage.setItem("userId",o.Correo)})).catch((function(e){console.log(e)})).then((()=>{r=localStorage.getItem("Session")})),r})(t,o);r?h(r):console.log("Error")};return null===localStorage.getItem("Session")?n("form",{className:"box",onSubmit:g,children:[i("h2",{children:"Loging"}),i("input",{onChange:m,type:"text",name:"username",placeholder:"Username"}),i("input",{onChange:p,type:"password",name:"password",placeholder:"Password"}),i("button",{type:"submit",value:"Login",children:"Loging"}),i(u,{to:"./newUser",children:i("h3",{children:"Nuevo usuario"})})]}):i(d,{to:"/home"})},j=RegExp(/^[a-zA-Z0-9.!#$%&â€™*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/),P=e=>{var a=e,{formErrors:s}=a,l=((e,a)=>{var s={};for(var l in e)r.call(e,l)&&a.indexOf(l)<0&&(s[l]=e[l]);if(null!=e&&t)for(var l of t(e))a.indexOf(l)<0&&o.call(e,l)&&(s[l]=e[l]);return s})(a,["formErrors"]);let n=!0;return Object.values(s).forEach((e=>{e.length>3&&(n=!1)})),Object.values(l).forEach((e=>{null===e&&(n=!1)})),n},A=()=>(p()(k(localStorage.getItem("Session")||"")),i(d,{to:"/home"}));class _ extends l.exports.Component{constructor(e){super(e),s(this,"onImputChanges",(e=>{e.preventDefault();const{name:s,value:l}=e.target;let n=((e,s)=>{for(var l in s||(s={}))r.call(s,l)&&a(e,l,s[l]);if(t)for(var l of t(s))o.call(s,l)&&a(e,l,s[l]);return e})({},this.state.formErrors);switch(s){case"nombre":n.nombre=l.length<3?"minimum 3 characaters required":"";break;case"apellido":n.apellido=l.length<3?"minimum 8 characaters required":"";break;case"email":n.email=j.test(l)?"":"invalid email address";break;case"password":n.password=l.length<6?"minimum 6 characaters required":""}this.setState({formErrors:n,[s]:l})})),s(this,"onSubmit",(async e=>{e.preventDefault();const t=this.state,r={Nombre:t.nombre+t.apellido,Correo:t.email,Foto:t.email,Clave:t.password};if(P(t))console.error("FORM INVALID - DISPLAY ERROR MESSAGE");else{const e=JSON.stringify(r);c.put("http://localhost:9080/registro/",e).then((async e=>{if(e.data.id)return this.setState({token:e.data.id}),localStorage.setItem("Session",this.state.token),A})).catch((function(e){console.log(e)}))}})),this.state={nombre:"",apellido:"",email:"",token:localStorage.getItem("Session"),password:"",formErrors:{nombre:"",apellido:"",email:"",password:""}}}render(){const{formErrors:e}=this.state;return this.state.token?i(d,{to:"/home"}):n("form",{className:"box",onSubmit:this.onSubmit,children:[i("h2",{children:"Loging"}),n("div",{children:[i("input",{onChange:this.onImputChanges,type:"text",name:"nombre",placeholder:"Nombre",className:e.nombre.length<3?"error":null}),e.nombre.length>3&&i("p",{id:"emailHelp",className:"errorMessage ",children:e.nombre})]}),n("div",{children:[i("input",{onChange:this.onImputChanges,type:"text",name:"apellido",placeholder:"Apellido",className:e.apellido.length<3?"error":null}),e.apellido.length>3&&i("p",{id:"emailHelp",className:"errorMessage ",children:e.apellido})]}),n("div",{children:[i("input",{onChange:this.onImputChanges,type:"text",name:"email",placeholder:"Email",className:e.email.length>3?"error":null}),e.email.length>3&&i("p",{id:"emailHelp",className:"errorMessage ",children:e.email})]}),n("div",{children:[i("input",{onChange:this.onImputChanges,type:"password",name:"password",placeholder:"Password",className:e.password.length>3?"error":null}),e.password.length>3&&i("p",{id:"emailHelp",className:"errorMessage ",children:e.password})]}),i("button",{type:"submit",value:"Login",children:"Loging"})]})}}function D(){return n(g,{children:[i(L,{}),n(f,{children:[i(b,{path:"/home",element:i(N,{})}),i(b,{path:"/",element:i(O,{})}),i(b,{path:"/newUser",element:i(_,{})})]})]})}var F=v({reducer:{autorize:E}});S.render(i(y,{store:F,children:i(D,{})}),document.getElementById("root"));
